<div *ngIf="!isPage">
  <app-modules-not-found></app-modules-not-found>
</div>
<div
  *ngIf="isPage"
  class="talks"
>
  <div *ngIf="isLoading">
    <app-modules-page-loading style="color:'white'"></app-modules-page-loading>
  </div>
  <app-talk-left-sidebar
    [isInRoom]="isInRoom"
    [isMobileDevice]="isMobileDevice"
    [isScreenSharing]="isScreenSharing"
    (clickCreateRoom)="handleClickCreateRoom()"
    (clickJoinRoom)="handleClickJoinRoom()"
    (clickLeaveRoom)="handleClickLeaveRoom()"
    (clickStartScreenSharing)="handleClickStartScreenSharing()"
    (clickStopScreenSharing)="handleClickStopScreenSharing()"
  ></app-talk-left-sidebar>
  <app-talk-room-entrance
    *ngIf="!isInRoom && talkContents"
    [roomContents]="roomContents"
    (clickBackToJoinedRoom)="handleClickBackToJoinedRoom($event)"
    (clickRemoveRoom)="handleClickRemoveRoom($event)"
  ></app-talk-room-entrance>
  <div class="copy-to-clipboard">
    <button
      *ngIf="isInRoom"
      class="btn btn-secondary"
      (click)="copyToClipboard(createdRoomUrl)"
    >Copy to Clipboard</button>
    <span
      *ngIf="isCopiedToClipboard"
      class="badge badge-success ml-2"
    ><i class="fa fa-check-circle mr-1"></i>Copied!</span>
    <p>{{createdRoomUrl}}</p>
  </div>


  <video
    id="localVideo"
    class="hidden-video"
    #localVideo
    autoplay
    playsinline
  ></video>
  <div
    *ngIf="isInRoom"
    id="videos"
    #videos
    [class.horizontal]="isHorizontalVideo"
  > 
    <div
      id="localVideoGroup"
      #localVideoGroup
      [class.horizontal]="isHorizontalVideo"
    >
      <canvas
        id="localCanvas"
        [ngStyle]="{'zoom': localCanvasZoom}"
        [hidden]="!isMobileDevice"
        #localCanvas
      ></canvas>
      <video
        id="canvasVideo"
        #canvasVideo
        [class.horizontal]="isHorizontalVideo"
        [class.full-screen-zoom]="isFullScreen"
        [class.hidden-video]="isMobileDevice"
      >
      </video>
      <span
        class="container"
        [class.horizontal]="isHorizontalVideo"
        [class.full-screen-zoom]="isFullScreen"
        (click)="isShowingLocalControl=!isShowingLocalControl"
        (mouseenter)="isShowingLocalControl=true"
        (mouseleave)="isShowingLocalControl=false"
      >
        <div
          *ngIf="isShowingLocalControl"
          class="video-button-group"
          [class.video-button-group-min]="isVideoButtonGroupHeightMininum"
        >
          <button
            class="btn video-button fa"
            [class.btn-danger]="isLocalVideoOn"
            [class.fa-eye-slash]="isLocalVideoOn"
            [class.btn-secondary]="!isLocalVideoOn"
            [class.fa-eye]="!isLocalVideoOn"
            (click)="clickLocalVideoToggle()"
          ></button>
          <button
            class="btn video-button fa"
            [class.btn-danger]="isLocalAudioOn"
            [class.fa-microphone-slash]="isLocalAudioOn"
            [class.btn-secondary]="!isLocalAudioOn"
            [class.fa-microphone]="!isLocalAudioOn"
            (click)="clickLocalAudioToggle()"
          ></button>
          <button
            class="btn btn-secondary video-button fa fa-expand"
            [class.fa-compress]="isFullScreen"
            (click)="toggleFullScreen(localVideoGroup)"
          ></button>
        </div>
      </span>
    </div>

    <div
      id="remoteVideoGroup"
      #remoteVideoGroup
      [class.horizontal]="isHorizontalVideo"
    >
      <video
        id="remoteVideo"
        #remoteVideo
        autoplay
        playsinline
        [class.horizontal]="isHorizontalVideo"
        [class.full-screen-zoom]="isFullScreen"
      >
      </video>
      <span
        class="container"
        [class.horizontal]="isHorizontalVideo"
        [class.full-screen-zoom]="isFullScreen"
        (click)="isShowingRemoteControl=!isShowingRemoteControl"
        (mouseenter)="isShowingRemoteControl=true"
        (mouseleave)="isShowingRemoteControl=false"
      >
        <div
          *ngIf="isShowingRemoteControl && hasRemoteConnection"
          class="video-button-group"
          [class.video-button-group-min]="isVideoButtonGroupHeightMininum"
        >
          <button
            class="btn video-button fa"
            [class.btn-danger]="isRemoteVideoOn"
            [class.fa-eye-slash]="isRemoteVideoOn"
            [class.btn-secondary]="!isRemoteVideoOn"
            [class.fa-eye]="!isRemoteVideoOn"
            (click)="clickRemoteVideoToggle()"
          ></button>
          <button
            class="btn video-button fa"
            [class.btn-danger]="isRemoteAudioOn"
            [class.fa-microphone-slash]="isRemoteAudioOn"
            [class.btn-secondary]="!isRemoteAudioOn"
            [class.fa-microphone]="!isRemoteAudioOn"
            (click)="clickRemoteAudioToggle()"
          ></button>
          <button
            class="btn btn-secondary video-button fa"
            [class.fa-expand]="!isFullScreen"
            [class.fa-compress]="isFullScreen"
            (click)="toggleFullScreen(remoteVideoGroup)"
          ></button>
        </div>
      </span>
    </div>
  </div>
</div>
